# Hello 11ty!

Oh hi! Welcome to your new blog. 🎡

[![Open in GitHub Codespaces](https://github.com/codespaces/badge.svg)](https://codespaces.new/glitchdotcom/11ty-to-compute)

**You can publish this site to Fastly for free!**

This project is a blog powered by [Eleventy](https://www.11ty.dev/), a lightweight static site generator that builds plain HTML files for quick loading by your visitors.

In this guide we'll show you how to deploy your blog to <a href="https://www.fastly.com/products/edge-compute" target="_blank">Fastly Compute</a> for super fast performance – your great posts will immediately be available for everyone, everywhere all at once. 🪄

> You can alternatively deploy your blog to other platforms, like <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>. 

## Remix your own blog

When you click the **Open in GitHub Codespaces** button in [this repository](https://github.com/glitchdotcom/11ty-to-compute), GitHub will clone the repo into your account and create a new Codespace for you to edit it. Once you have your own copy of the repo, you can click **Code** > **Codespaces** at any time. Make sure you **commit** any changes you make if you want to keep them in your repo as GitHub will only keep your Codespace for a limited time.

<img alt="Create codespace" src="https://github.com/user-attachments/assets/cb29a8da-d1ac-42f5-962c-7d43b8011324" width="400px"/>

Give the Codespace a minute or two to start up – it'll automatically build and run your new website, opening a preview to see your site update as you edit! 

![The blog in a Codespace](https://github.com/user-attachments/assets/a86b11ed-76d5-4f74-9918-617e164d5c73)

* When your website preview opens, click the **🔎 Split** button at the bottom so that you can see the site side by side with your code.
* _You can close [x] the **Terminal** while you work._

## Get to know your blog

You can make edits in the files by opening them from the left sidebar. Your blog preview will update as you edit!

The files you'll want to edit are mostly in the `source` and `assets` directories:

📝 Edit the post content and add new posts in `source/posts`.

💡 Change your site HTML in the `source/_layouts` files.

ℹ️ Edit the metadata for your site in the `source/_data` folder.

🎨 Change your site style rules in `assets/style.css`.

🖼️ Add images in the `assets/` folder – you'll find an example of adding an image to a post in `source/posts/fourth-post.md`.

![Editing a post](https://github.com/user-attachments/assets/5a972e39-c9c7-48f6-b3f0-00e7c5aa52a7)

> 🚨⚠️ Danger zone: There are directories in the project that you might want to be careful with..
>
> * The `_site` folder is autogenerated by 11ty so best not to edit in there.
> * The `_app` folder is autogenerated by the Fastly tooling so you should only edit in there if you want to change the Compute app you deploy to the edge.
> * The `helpers` folder contains the bash scripts that run when your project starts and when you hit the **🚀 Publish** button.

### Share your draft site 

Share your draft site with collaborators by opening **💻 Terminal** > **PORTS**.

Change `private` to `public` by right clicking your running port and choosing from the options.

![Change the port settings](https://github.com/user-attachments/assets/31802b6e-b766-4b5b-8b59-529d31fdf4ee)

Copy the URL to your clipboard and share it 📋.

<img alt="Copy the URL" src="https://github.com/user-attachments/assets/a4704062-29e1-45b4-91e7-02599f001967" width="600px"/>

## Deploy your blog to Fastly Compute

Ready to share your site with the world? Deploy it to Fastly to make it available for everyone everywhere all at once!

Grab a Fastly API key from your account and add it to your GitHub repo:

- Sign up for a <strong><a href="https://www.fastly.com/signup/" target="_blank">free Fastly developer account</a></strong>
- Grab an **API Token** from **Account** > **Personal Profile** > **API Tokens** > **Create Token**
  - _Type_: Automation
  - _Role_: Engineer
  - _Scope_: Global (deselect the _Read-only access_ box)
  - _Access_: All services
  - _Expiration_: Never expire
- **Copy the token value into your GitHub repo**
  - Open **Settings** > **Secrets and Variables** > **Codespaces**
  - Create a **New repository secret**
  - Enter the name `FASTLY_API_TOKEN`
  - Paste your token value in and save

Back in your Codespace, you should see a prompt to reload for the new environment variable so go ahead and click that.

Hit the **🚀 Publish** button and watch the Terminal output for your new site address!

![New Compute app address in the Terminal](https://github.com/user-attachments/assets/0a5a8f84-4907-4d60-83da-d3b90e745562)

You'll see your new `*.edgecompute.app` address in the output. Open it in a new tab and tell everyone you know. 📣

🎢 Whenever you update your content, like adding a new blog post, hit the **🚀 Publish** button again to go live!

## Save your edits to GitHub

GitHub will keep the edits you make in the Codespace only for a limited time, so each time you finish an editing session it's best to commit your work to a branch. You can commit directly to your main repo branch, but you'll find it easier to revert changes later if you need to by saving your edits to a new branch:

* In your Codespace, click the branch name at the bottom (by default it'll be `main`).
* Choose **Create new branch from** and select the `HEAD` option.
* Give your new branch a name.
* Push your changes to GitHub, choosing your repo as the remote when prompted.
  * <img src="https://github.com/user-attachments/assets/03cddf4f-3c90-4c80-999f-ab40e8aa7ea4" alt="push changes" width="300px"/>
* This will copy your edits to the branch – you can go ahead and create a Pull Request by clicking the notification in your Codespace.
  * Choose your repo as the base (not the Glitch one you forked) and open the Pull Request.
  * You can go ahead and merge from inside the Codespace.
    * ![Image](https://github.com/user-attachments/assets/3ecd5da2-16f1-4ccb-97c9-8b715d964d42)

> GitHub will notify you if any of your Codespaces are about to expire. If you have changes you want to keep, you can use the **Export changes to a branch** option.
> 
> <img alt="export to branch" width="600px" src="https://github.com/user-attachments/assets/c7815347-3e5a-4e34-97f2-db58343acaa4"/>

## How this project works 🧐

This project uses the <a href="https://github.com/fastly/compute-js-static-publish" target="_blank">Fastly JavaScript Static Publisher</a> to turn your blog into a serverless application that runs at the network edge, near your users. 

* The 11ty framework builds your posts into the HTML and other files that make up your website, placing them in the `_site` folder.
* The Static Publisher uses those files to scaffold a Compute app that compiles into Webassembly (Wasm) that can run fast and securely on the Fastly network – you'll find the Compute code in `_app` after you deploy.
* When you publish, the project deploys the app to Fastly, creating a service and uploading the Wasm to it.
* It then then publishes your content to a KV Store – a key-value store that also runs on Fastly and that your app can talk to.

Your app only needs deployed to Fastly once, after that we just update the new content to your KV Store and your Compute app will pull your posts from there.

⚙️ The settings we use to create the guided experience in Codespaces are in the `.devcontainer/` folder.

🧰 You'll find the Fastly CLI commands we use under the hood in the `helpers/publish.sh` script.

## Extensions

This project uses the following extensions from the dev community! 🙌

* [VSCode Action Buttons Ext](https://marketplace.visualstudio.com/items?itemName=jkearins.action-buttons-ext)
* [ESLint](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint)

## Keep going! 🛸

**Don't stop there, <a href="https://www.fastly.com/documentation/solutions/tutorials/deliver-your-site/#sending-domain-traffic-to-fastly" target="_blank">add a domain to your new site</a>.**

Check out lots more tips on using the <a href="https://github.com/fastly/compute-js-static-publish" target="_blank">Static Publisher</a> in its repo `README`. Note that if you make changes to the Compute code, you'll need to run a separate deploy command to deploy your changes to Fastly as the **🚀 Publish** button will only deploy once, after that it'll just update your content.

🛟 Get help on the <a href="https://community.fastly.com" target="_blank">community forum</a>.

<img src="https://github.com/user-attachments/assets/17a8af4a-100f-416d-a1cf-f84174262138" width="100px"/>
